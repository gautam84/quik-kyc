// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"

}



model User {
  id        BigInt   @id @default(autoincrement())
  supabase_uid String @unique @db.Uuid
  mobile_number String @db.VarChar(15)

  // KYC Status and Progress
  kyc_status String @default("pending") @db.VarChar(50)
  kyc_step   String @default("onboarding") @db.VarChar(50)

  // Personal Information
  full_name     String? @db.VarChar(255)
  email         String? @db.VarChar(255)
  date_of_birth DateTime? @db.Date
  passport_photo_url String? @db.Text

  // Identity Document Details
  identity_doc_type       String? @db.VarChar(50)
  identity_doc_number     String? @db.VarChar(100)
  identity_doc_image_url  String? @db.Text
  identity_doc_front_url  String? @db.Text
  identity_doc_back_url   String? @db.Text

  // Address Document Details
  address_doc_type        String? @db.VarChar(50)
  address_doc_number      String? @db.VarChar(100)
  address_doc_image_url   String? @db.Text
  address_doc_front_url   String? @db.Text
  address_doc_back_url    String? @db.Text
  address_line            String? @db.Text

  // Liveness Check
  selfie_image_url   String? @db.Text
  liveness_verified  Boolean @default(false)

  // Reference ID for completed KYC
  reference_id String? @unique @db.VarChar(50)

  // Timestamps
  created_at   DateTime  @default(now()) @db.Timestamptz(6)
  updated_at   DateTime  @default(now()) @updatedAt @db.Timestamptz(6)
  completed_at DateTime? @db.Timestamptz(6)

  @@index([supabase_uid])
  @@index([mobile_number])
  @@index([reference_id])
  @@index([kyc_status])
  @@map("users")
}
